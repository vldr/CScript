var Interpreter;(()=>{"use strict";var e={};({719:function(e,r){var t,i=this&&this.__awaiter||function(e,r,t,i){return new(t||(t=Promise))((function(n,s){function a(e){try{g(i.next(e))}catch(e){s(e)}}function o(e){try{g(i.throw(e))}catch(e){s(e)}}function g(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,o)}g((i=i.apply(e,r||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(){this._registerA=new Uint32Array([0]),this._registerB=new Uint32Array([0]),this._registerR=new Uint32Array([0]),this._stack=new Array,this._callStack=new Array,this._output=e=>{process.stdout.write(e)},this._labels=new Map,this._memoryRegions=new Map}get registerA(){return this._registerA.slice(0)}get registerB(){return this._registerB.slice(0)}get registerR(){return this._registerR.slice(0)}get stack(){return this._stack}get memoryRegions(){return this._memoryRegions}run(e){return i(this,void 0,void 0,(function*(){if(yield this.runWithoutStackCheck(e),0!==this.stack.length)throw Error("stack is not empty.")}))}runWithoutStackCheck(e){return i(this,void 0,void 0,(function*(){this._instructions=e.split("\n").map((e=>e.replace("\n","").trim())),this._programCounter=0,this._ticks=0,yield this.initExports(),this.processLabels(),this.processMemoryRegions(),this.processInstructions()}))}setOutput(e){return i(this,void 0,void 0,(function*(){this._output=e}))}initExports(){return i(this,void 0,void 0,(function*(){const e=new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,2,127,127,1,127,96,2,125,125,1,125,3,11,10,0,0,0,0,0,0,1,1,1,1,7,67,10,3,97,100,100,0,0,3,115,117,98,0,1,3,109,117,108,0,2,3,114,101,109,0,5,4,105,100,105,118,0,3,4,117,100,105,118,0,4,4,102,97,100,100,0,6,4,102,115,117,98,0,7,4,102,109,117,108,0,8,4,102,100,105,118,0,9,10,81,10,7,0,32,0,32,1,106,11,7,0,32,0,32,1,107,11,7,0,32,0,32,1,108,11,7,0,32,0,32,1,109,11,7,0,32,0,32,1,110,11,7,0,32,0,32,1,112,11,7,0,32,0,32,1,146,11,7,0,32,0,32,1,147,11,7,0,32,0,32,1,148,11,7,0,32,0,32,1,149,11]),r=yield WebAssembly.compile(e),t=yield WebAssembly.instantiate(r,{});this._exports=t.exports}))}getFloatingPointValue(e){if(e instanceof Uint32Array||e instanceof Int32Array)return new DataView(e.buffer).getFloat32(0,!0);if(e instanceof Float32Array)return e[0];throw new Error("Unknown datatype to convert to floating point value.")}getIntegerValue(e){if(e instanceof Uint32Array||e instanceof Int32Array||e instanceof Float32Array)return new DataView(e.buffer).getInt32(0,!0);throw new Error("Unknown datatype to convert to floating point value.")}getUnsignedIntegerValue(e){if(e instanceof Uint32Array||e instanceof Int32Array||e instanceof Float32Array)return new DataView(e.buffer).getUint32(0,!0);throw new Error("Unknown datatype to convert to floating point value.")}jumpToLocation(e,r){let i=String();switch(r){case t.Operand:e.operand&&(i=e.operand);break;case t.Arg0:e.arg0&&(i=e.arg0);break;case t.Arg1:e.arg1&&(i=e.arg1)}const n=this._labels.get(i);if(this._memoryRegions.get(i))throw e.error(r,"Cannot jump to a memory location.");if(!n)throw e.error(r,"Invalid label location provided.");this.jumpToLocationByAddress(e,n.lineNumber)}jumpToLocationByAddress(e,r){if(r<0||r>this._instructions.length)throw e.error(t.Operand,"Address is out of bounds.");this._programCounter=r,this._didModifyProgramCounter=!0}getNumericValue(e,r){let i=String();switch(r){case t.Operand:e.operand&&(i=e.operand);break;case t.Arg0:e.arg0&&(i=e.arg0);break;case t.Arg1:e.arg1&&(i=e.arg1)}let n=this._labels.get(i);if(n)return new Uint32Array([n.address]);if(i.endsWith("f")){i=i.replace("f","");const t=Number.parseFloat(i);if(Number.isNaN(t))throw e.error(r,"Invalid floating point value provided.");return new Float32Array([t])}{const t=Number.parseInt(i);if(i.includes(".")||Number.isNaN(t))throw e.error(r,"Invalid value provided.");return t<0?new Int32Array([t]):new Uint32Array([t])}}getMemoryValue(e,r){let i=String();switch(r){case t.Operand:e.operand&&(i=e.operand);break;case t.Arg0:e.arg0&&(i=e.arg0);break;case t.Arg1:e.arg1&&(i=e.arg1)}const n=this._memoryRegions.get(i);if(!n)throw e.error(r,"Invalid memory region provided.");return n.slice(0)}setMemoryValue(e,r,t){this.setMemoryNumericValue(e,r,this.getNumericValue(e,t))}setMemoryNumericValue(e,r,i){let n=String();switch(r){case t.Operand:e.operand&&(n=e.operand);break;case t.Arg0:e.arg0&&(n=e.arg0);break;case t.Arg1:e.arg1&&(n=e.arg1)}if(!this._memoryRegions.get(n))throw e.error(r,"Invalid memory region provided.");this._memoryRegions.set(n,i.slice(0))}setMemoryNumericValueByAddress(e,r,i){let n;if(this._labels.forEach(((e,t)=>{e.address===r&&(n=t)})),!n)throw e.error(t.Operand,"Unable to resolve line number to a label.");if(!this._memoryRegions.get(n))throw e.error(t.Operand,"The corresponding address does not corresponding to a given memory region (buffer overrun?).");this._memoryRegions.set(n,i.slice(0))}getMemoryNumericValueByAddress(e,r){let i;if(this._labels.forEach(((e,t)=>{e.address===r&&(i=t)})),!i)throw e.error(t.Operand,"Unable to resolve line number to a label.");const n=this._memoryRegions.get(i);if(n)return n;throw e.error(t.Operand,"The corresponding address does not corresponding to a given memory region (buffer overrun?).")}pushMemory(e,r){let t=this.getMemoryValue(e,r);this._stack.push(t.slice(0))}pushNumericValue(e,r){let t=this.getNumericValue(e,r);this._stack.push(t.slice(0))}moveValue(e,r,i){const n=this._stack[r],s=this._stack.splice(r,1);if(!n||s.length<=0)throw e.error(t.Operand,"Stack was immovable.");this.pushValue(e,n)}pushValue(e,r){this._stack.push(r.slice(0))}popValue(e){const r=this._stack.pop();if(!r)throw e.error(t.Operand,"Stack was empty.");return r.slice(0)}processMemoryRegions(){this._labels.forEach(((e,r)=>{if(e.lineNumber in this._instructions){const i=new s(this._instructions[e.lineNumber],e.lineNumber);i.arg0&&".data"===i.operand&&this._memoryRegions.set(r,this.getNumericValue(i,t.Arg0))}}))}processLabels(){let e=0;for(let r=0;r<this._instructions.length;r++){const t=this._instructions[r],i=new s(t,r);"HALT"===i.operand||"GETAVB"===i.operand||"GETA"===i.operand||"GETB"===i.operand||"VGETA"===i.operand||"VGETB"===i.operand||"PUSH"===i.operand||"VPUSH"===i.operand||"SAVEPUSH"===i.operand||"SAVEPUSHA"===i.operand||"SAVEPUSHB"===i.operand||"SAVEFRONT"===i.operand||"MOVOUTPUSH"===i.operand||"POP"===i.operand||"GETPOPA"===i.operand||"GETPOPB"===i.operand||"GETPOPR"===i.operand||"POPNOP"===i.operand||"MOVINPOP"===i.operand||"SAVE"===i.operand||"SAVEA"===i.operand||"SAVEB"===i.operand||"SAVETOA"===i.operand||"SAVETOB"===i.operand||"JA"===i.operand||"JNA"===i.operand||"JMP"===i.operand||"CALL"===i.operand||"RTN"===i.operand||"MOV"===i.operand||"MOVIN"===i.operand||"MOVOUT"===i.operand||"ADD"===i.operand||"FADD"===i.operand||"SADD"===i.operand||"MULT"===i.operand||"FMULT"===i.operand||"SMULT"===i.operand||"DIV"===i.operand||"FDIV"===i.operand||"SDIV"===i.operand||"SUB"===i.operand||"FSUB"===i.operand||"SSUB"===i.operand||"CMPE"===i.operand||"CMPNE"===i.operand||"CMPLT"===i.operand||"CMPLTE"===i.operand||"CMPGT"===i.operand||"CMPGTE"===i.operand||"SCMPE"===i.operand||"SCMPNE"===i.operand||"SCMPLT"===i.operand||"SCMPLTE"===i.operand||"SCMPGT"===i.operand||"SCMPGTE"===i.operand||"FCMPE"===i.operand||"FCMPNE"===i.operand||"FCMPLT"===i.operand||"FCMPLTE"===i.operand||"FCMPGT"===i.operand||"FCMPGTE"===i.operand||"NEG"===i.operand||"SNEG"===i.operand||"FNEG"===i.operand||"INC"===i.operand||"DEC"===i.operand||"FINC"===i.operand||"FDEC"===i.operand||"REM"===i.operand||"AND"===i.operand||"SHIFTL"===i.operand||"SHIFTR"===i.operand||"OR"===i.operand||"XOR"===i.operand||"NOT"===i.operand||"FLTOINT"===i.operand||"INTTOFL"===i.operand||"LAND"===i.operand||"LOR"===i.operand||"QADD"===i.operand||"QSUB"===i.operand||"QLADD"===i.operand||"QLSUB"===i.operand||"QSTORE"===i.operand||"TICK"===i.operand||"RAND"===i.operand||"PRINT"===i.operand||".data"===i.operand?e+=1:"STORE"===i.operand||"STOREPUSH"===i.operand?e+=2:t.endsWith(":")&&this._labels.set(t.replace(":",""),new n(e,r+1))}}processInstructions(){for(;;){const e=new s(this._instructions[this._programCounter],this._programCounter);if(this._didModifyProgramCounter=!1,this._ticks++,e.operand){if("HALT"===e.operand)break;if("GETA"===e.operand||"GETB"===e.operand||"VGETA"===e.operand||"VGETB"===e.operand)this.interpretGET(e);else if("PUSH"===e.operand||"VPUSH"===e.operand||"SAVEPUSH"===e.operand||"SAVEPUSHA"===e.operand||"SAVEPUSHB"===e.operand||"SAVEFRONT"===e.operand||"MOVOUTPUSH"===e.operand||"STOREPUSH"===e.operand)this.interpretPUSH(e);else if("POP"===e.operand||"GETPOPA"===e.operand||"GETPOPB"===e.operand||"GETPOPR"===e.operand||"POPNOP"===e.operand||"MOVINPOP"===e.operand)this.interpretPOP(e);else if("SAVE"===e.operand||"SAVEA"===e.operand||"SAVEB"===e.operand||"SAVETOA"===e.operand||"SAVETOB"===e.operand)this.interpretSAVE(e);else if("JA"===e.operand||"JNA"===e.operand||"JMP"===e.operand||"CALL"===e.operand||"RTN"===e.operand)this.interpretJUMP(e);else if("MOV"===e.operand||"MOVIN"===e.operand||"MOVOUT"===e.operand)this.interpretMOVE(e);else if("ADD"===e.operand||"FADD"===e.operand||"SADD"===e.operand||"MULT"===e.operand||"FMULT"===e.operand||"SMULT"===e.operand||"DIV"===e.operand||"FDIV"===e.operand||"SDIV"===e.operand||"SUB"===e.operand||"FSUB"===e.operand||"SSUB"===e.operand||"CMPE"===e.operand||"CMPNE"===e.operand||"CMPLT"===e.operand||"CMPLTE"===e.operand||"CMPGT"===e.operand||"CMPGTE"===e.operand||"SCMPE"===e.operand||"SCMPNE"===e.operand||"SCMPLT"===e.operand||"SCMPLTE"===e.operand||"SCMPGT"===e.operand||"SCMPGTE"===e.operand||"FCMPE"===e.operand||"FCMPNE"===e.operand||"FCMPLT"===e.operand||"FCMPLTE"===e.operand||"FCMPGT"===e.operand||"FCMPGTE"===e.operand||"NEG"===e.operand||"SNEG"===e.operand||"FNEG"===e.operand||"INC"===e.operand||"DEC"===e.operand||"FINC"===e.operand||"FDEC"===e.operand||"REM"===e.operand||"AND"===e.operand||"SHIFTL"===e.operand||"SHIFTR"===e.operand||"OR"===e.operand||"XOR"===e.operand||"NOT"===e.operand||"FLTOINT"===e.operand||"INTTOFL"===e.operand||"LAND"===e.operand||"LOR"===e.operand)this.interpretCOMPUTE(e);else if("QADD"===e.operand||"QSUB"===e.operand||"QLADD"===e.operand||"QLSUB"===e.operand||"QSTORE"===e.operand||"STORE"===e.operand)this.interpretSTORE(e);else if("TICK"===e.operand||"RAND"===e.operand||"PRINT"===e.operand||"GETAVB"===e.operand)this.interpretSPECIAL(e);else if("#"===e.operand);else if(!this._instructions[this._programCounter].endsWith(":"))throw e.error(t.Operand,"Unimplemented instruction '"+e.operand+"'.")}this._didModifyProgramCounter||this._programCounter++}}interpretGET(e){var r,i,n;let s;s=(null===(r=e.operand)||void 0===r?void 0:r.startsWith("V"))?this.getNumericValue(e,t.Arg0):this.getMemoryValue(e,t.Arg0),(null===(i=e.operand)||void 0===i?void 0:i.endsWith("A"))?this._registerA=s:(null===(n=e.operand)||void 0===n?void 0:n.endsWith("B"))?this._registerB=s:e.error(t.Operand,"Unknown operand for GET-like instruction.")}interpretPUSH(e){if("PUSH"===e.operand)this.pushMemory(e,t.Arg0);else if("VPUSH"===e.operand||"STOREPUSH"===e.operand)this.pushNumericValue(e,t.Arg0);else if("SAVEPUSH"===e.operand)this.pushValue(e,this._registerR);else if("SAVEPUSHA"===e.operand)this.pushValue(e,this._registerA);else if("SAVEPUSHB"===e.operand)this.pushValue(e,this._registerB);else if("SAVEFRONT"===e.operand)this.moveValue(e,this._stack.length-1-Number(e.arg0),this._stack.length-1);else if("MOVOUTPUSH"===e.operand){const r=new Uint32Array(this._registerR)[0],t=this.getMemoryNumericValueByAddress(e,r);this.pushValue(e,t)}else e.error(t.Operand,"Unknown operand for PUSH-like instruction.")}interpretPOP(e){const r=this.popValue(e);if("POP"===e.operand)this.setMemoryNumericValue(e,t.Arg0,r);else if("GETPOPA"===e.operand)this._registerA=r;else if("GETPOPB"===e.operand)this._registerB=r;else if("GETPOPR"===e.operand)this._registerR=r;else if("MOVINPOP"===e.operand){const t=new Uint32Array(r)[0];this.setMemoryNumericValueByAddress(e,t,this._registerR)}else"POPNOP"===e.operand||e.error(t.Operand,"Unknown operand for POP-like instruction.")}interpretSAVE(e){"SAVE"===e.operand?this.setMemoryNumericValue(e,t.Arg0,this._registerR):"SAVEA"===e.operand?this.setMemoryNumericValue(e,t.Arg0,this._registerA):"SAVEB"===e.operand?this.setMemoryNumericValue(e,t.Arg0,this._registerB):"SAVETOA"===e.operand?this._registerA=this.registerR.slice(0):"SAVETOB"===e.operand?this._registerB=this.registerR.slice(0):e.error(t.Operand,"Unknown operand for SAVE-like instruction.")}interpretJUMP(e){if("JA"===e.operand)0!=this.getUnsignedIntegerValue(this._registerA)&&this.jumpToLocation(e,t.Arg0);else if("JNA"===e.operand)0==this.getUnsignedIntegerValue(this._registerA)&&this.jumpToLocation(e,t.Arg0);else if("JMP"===e.operand)this.jumpToLocation(e,t.Arg0);else if("RTN"===e.operand){const r=this._callStack.pop();if(!r)throw e.error(t.Operand,"Call stack is empty.");this.jumpToLocationByAddress(e,r)}else"CALL"===e.operand?(this._callStack.push(this._programCounter+1),this.jumpToLocation(e,t.Arg0)):e.error(t.Operand,"Unknown operand for JUMP-like instruction.")}interpretMOVE(e){if("MOV"===e.operand)this.setMemoryNumericValue(e,t.Arg1,this.getMemoryValue(e,t.Arg0));else if("MOVIN"===e.operand){const r=this.getMemoryValue(e,t.Arg0),i=new Uint32Array(this._registerR)[0];this.setMemoryNumericValueByAddress(e,i,r)}else if("MOVOUT"===e.operand){const r=this.getMemoryNumericValueByAddress(e,new Uint32Array(this._registerR)[0]);this.setMemoryNumericValue(e,t.Arg0,r)}else e.error(t.Operand,"Unknown operand for MOVE-like instruction.")}interpretCOMPUTE(e){"SADD"===e.operand?this._registerR=new Int32Array([this._exports.add(this.getIntegerValue(this._registerA),this.getIntegerValue(this._registerB))]):"FADD"===e.operand?this._registerR=new Float32Array([this._exports.fadd(this.getFloatingPointValue(this._registerA),this.getFloatingPointValue(this._registerB))]):"ADD"===e.operand?this._registerR=new Uint32Array([this._exports.add(this.getUnsignedIntegerValue(this._registerA),this.getUnsignedIntegerValue(this._registerB))]):"SSUB"===e.operand?this._registerR=new Int32Array([this._exports.sub(this.getIntegerValue(this._registerA),this.getIntegerValue(this._registerB))]):"FSUB"===e.operand?this._registerR=new Float32Array([this._exports.fsub(this.getFloatingPointValue(this._registerA),this.getFloatingPointValue(this._registerB))]):"SUB"===e.operand?this._registerR=new Uint32Array([this._exports.sub(this.getUnsignedIntegerValue(this._registerA),this.getUnsignedIntegerValue(this._registerB))]):"SDIV"===e.operand?this._registerR=new Int32Array([this._exports.idiv(this.getIntegerValue(this._registerA),this.getIntegerValue(this._registerB))]):"FDIV"===e.operand?this._registerR=new Float32Array([this._exports.fdiv(this.getFloatingPointValue(this._registerA),this.getFloatingPointValue(this._registerB))]):"DIV"===e.operand?this._registerR=new Uint32Array([this._exports.udiv(this.getUnsignedIntegerValue(this._registerA),this.getUnsignedIntegerValue(this._registerB))]):"SMULT"===e.operand?this._registerR=new Int32Array([this._exports.mul(this.getIntegerValue(this._registerA),this.getIntegerValue(this._registerB))]):"FMULT"===e.operand?this._registerR=new Float32Array([this._exports.fmul(this.getFloatingPointValue(this._registerA),this.getFloatingPointValue(this._registerB))]):"MULT"===e.operand?this._registerR=new Uint32Array([this._exports.mul(this.getUnsignedIntegerValue(this._registerA),this.getUnsignedIntegerValue(this._registerB))]):"CMPE"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)==this.getUnsignedIntegerValue(this._registerB)?1:0]):"CMPNE"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)!=this.getUnsignedIntegerValue(this._registerB)?1:0]):"CMPGT"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)>this.getUnsignedIntegerValue(this._registerB)?1:0]):"CMPGTE"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)>=this.getUnsignedIntegerValue(this._registerB)?1:0]):"CMPLT"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)<this.getUnsignedIntegerValue(this._registerB)?1:0]):"CMPLTE"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)<=this.getUnsignedIntegerValue(this._registerB)?1:0]):"SCMPE"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)==this.getIntegerValue(this._registerB)?1:0]):"SCMPNE"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)!=this.getIntegerValue(this._registerB)?1:0]):"SCMPGT"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)>this.getIntegerValue(this._registerB)?1:0]):"SCMPGTE"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)>=this.getIntegerValue(this._registerB)?1:0]):"SCMPLT"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)<this.getIntegerValue(this._registerB)?1:0]):"SCMPLTE"===e.operand?this._registerR=new Uint32Array([this.getIntegerValue(this._registerA)<=this.getIntegerValue(this._registerB)?1:0]):"FCMPE"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)==this.getFloatingPointValue(this._registerB)?1:0]):"FCMPNE"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)!=this.getFloatingPointValue(this._registerB)?1:0]):"FCMPGT"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)>this.getFloatingPointValue(this._registerB)?1:0]):"FCMPGTE"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)>=this.getFloatingPointValue(this._registerB)?1:0]):"FCMPLT"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)<this.getFloatingPointValue(this._registerB)?1:0]):"FCMPLTE"===e.operand?this._registerR=new Uint32Array([this.getFloatingPointValue(this._registerA)<=this.getFloatingPointValue(this._registerB)?1:0]):"NEG"===e.operand?this._registerR=new Uint32Array([0!=this.getUnsignedIntegerValue(this._registerA)?0:1]):"SNEG"===e.operand?this._registerR=new Int32Array([-this.getIntegerValue(this._registerA)]):"FNEG"===e.operand?this._registerR=new Float32Array([-this.getFloatingPointValue(this._registerA)]):"INC"===e.operand?this._registerR=new Int32Array([this.getIntegerValue(this._registerA)+1]):"DEC"===e.operand?this._registerR=new Int32Array([this.getIntegerValue(this._registerA)-1]):"FINC"===e.operand?this._registerR=new Float32Array([this.getFloatingPointValue(this._registerA)+1]):"FDEC"===e.operand?this._registerR=new Float32Array([this.getFloatingPointValue(this._registerA)-1]):"REM"===e.operand?this._registerR=new Uint32Array([this._exports.rem(this.getUnsignedIntegerValue(this._registerA),this.getUnsignedIntegerValue(this._registerB))]):"AND"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)&this.getUnsignedIntegerValue(this._registerB)]):"SHIFTL"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)<<this.getUnsignedIntegerValue(this._registerB)]):"SHIFTR"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)>>>this.getUnsignedIntegerValue(this._registerB)]):"NOT"===e.operand?this._registerR=new Uint32Array([~this.getUnsignedIntegerValue(this._registerA)]):"OR"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)|this.getUnsignedIntegerValue(this._registerB)]):"XOR"===e.operand?this._registerR=new Uint32Array([this.getUnsignedIntegerValue(this._registerA)^this.getUnsignedIntegerValue(this._registerB)]):"FLTOINT"===e.operand?this._registerR=new Int32Array([this.getFloatingPointValue(this._registerA)]):"INTTOFL"===e.operand?this._registerR=new Float32Array([this.getIntegerValue(this._registerA)]):"LAND"===e.operand?this._registerR=new Uint32Array([0!=this.getUnsignedIntegerValue(this._registerA)&&0!=this.getUnsignedIntegerValue(this._registerB)?1:0]):"LOR"===e.operand?this._registerR=new Uint32Array([0!=this.getUnsignedIntegerValue(this._registerA)||0!=this.getUnsignedIntegerValue(this._registerB)?1:0]):e.error(t.Operand,"Unknown operand for COMPUTE-like instruction.")}interpretSTORE(e){if("QADD"===e.operand||"QSUB"===e.operand){const r=this.getNumericValue(e,t.Arg0),i=this.getNumericValue(e,t.Arg1);let n=this._exports.add;"QSUB"===e.operand&&(n=this._exports.sub),this._registerR=new Int32Array([n(this.getIntegerValue(r),this.getIntegerValue(i))])}else if("QLADD"===e.operand||"QLSUB"===e.operand){const r=this.getMemoryValue(e,t.Arg0),i=this.getNumericValue(e,t.Arg1);let n=this._exports.add;"QLSUB"===e.operand&&(n=this._exports.sub),this._registerR=new Int32Array([n(this.getIntegerValue(r),this.getIntegerValue(i))])}else"STORE"===e.operand||"QSTORE"===e.operand?this.setMemoryValue(e,t.Arg1,t.Arg0):e.error(t.Operand,"Unknown operand for STORE-like instruction.")}interpretSPECIAL(e){if("TICK"===e.operand)this._registerR=new Uint32Array([this._ticks]);else if("RAND"===e.operand){const e=(e,r)=>Math.random()*(r-e)+e;this._registerR=new Uint32Array([e(0,4294967295)])}else if("GETAVB"===e.operand){const r=this.getMemoryValue(e,t.Arg0),i=this.getNumericValue(e,t.Arg1);this._registerA=r,this._registerB=i}else if("PRINT"==e.operand){let r=new String;e.arg0?r+=decodeURI(e.arg0):r+=this.popValue(e).toString(),this._output(r.toString())}else e.error(t.Operand,"Unknown operand for SPECIAL-like instruction.")}},function(e){e[e.Operand=0]="Operand",e[e.Arg0=1]="Arg0",e[e.Arg1=2]="Arg1"}(t||(t={}));class n{constructor(e,r){this.address=e,this.lineNumber=r}}class s{constructor(e,r){this._instruction=e,this._lineNumber=r,this._instructionParts=e.split(" ")}get lineNumber(){return this._lineNumber}error(e,r){switch(e){case t.Operand:return this.generateError(this._instruction,this._lineNumber,0,this._instructionParts[0].length-1,r);case t.Arg0:return this.generateError(this._instruction,this._lineNumber,this._instructionParts[0].length+1,this._instructionParts[1].length-1,r);case t.Arg1:return this.generateError(this._instruction,this._lineNumber,this._instructionParts[0].length+this._instructionParts[1].length+2,this._instructionParts[2].length-1,r)}}generateError(e,r,t,i,n){let s=String();s+=`line ${r+1}: ${n}\n`,s+=`\t${e}\n`,s+="\t";for(let e=0;e<t;e++)s+=" ";s+="^";for(let e=0;e<i;e++)s+="~";return s+="\n",new Error(s)}get operand(){return this._instructionParts.length>=1?this._instructionParts[0]:void 0}get arg0(){return this._instructionParts.length>=2?this._instructionParts[1]:void 0}get arg1(){return this._instructionParts.length>=3?this._instructionParts[2]:void 0}get length(){return this._instructionParts.length}}}})[719](0,e),Interpreter=e.default})();